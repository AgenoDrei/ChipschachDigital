language: node_js
node_js: node
addons:
  ssh_known_hosts:
  - agenodrei.de
  - schach-fuer-kids.de
before_install:
- openssl aes-256-cbc -K $encrypted_72d64fbd7773_key -iv $encrypted_72d64fbd7773_iv
  -in secrets.tar.enc -out secrets.tar -d
- tar xvf secrets.tar
- eval "$(ssh-agent -s)"
- chmod 600 deploy_rsa
- ssh-add deploy_rsa
deploy:
- provider: script
  skip_cleanup: true
  script: rsync -r --exclude=$TRAVIS_BUILD_DIR/config --delete-after --quiet $TRAVIS_BUILD_DIR simon@agenodrei.de:~/travis
  on:
    branch: feature/cd
- provider: script
  skip_cleanup: true
  script: rsync -r --delete-after --quiet $TRAVIS_BUILD_DIR --password-file server.pass
    simon@schach-fuer-kids.de:~/travis
  on: 
    branch: master
